<!DOCTYPE html><html lang='en'><head prefix="og: http://ogp.me/ns/article#"><meta charset='utf-8'><title>How to create a robust and reliable Keyboard Maestro macro | Sayz Lim</title><meta name="description" content="I've written my fair share of macros and put together a series of tips to help you efficiently build and debug a macro."><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="/main.css?v=1659979020" as="style"><link rel="stylesheet" href="/main.css?v=1659979020" > <script src="/main.js?v=1659979020"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Viga&family=Karla:wght@300;400;500;600&display=swap" rel="stylesheet"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="apple-touch-icon" sizes="56x56" href="/img/apple-touch-icon-56x56.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><meta name="twitter:dnt" content="on"><meta name="format-detection" content="telephone=no"><link rel="alternate" type="application/rss+xml" title="Sayz Lim" href="https://sayzlim.net/atom.xml" /><meta property="og:title" content="How to create a robust and reliable Keyboard Maestro macro" /><meta property="og:type" content="article" /><meta property="og:url" content="https://sayzlim.net/keyboard-maestro-macro-tips/" /><meta property="og:description" content="I've written my fair share of macros and put together a series of tips to help you efficiently build and debug a macro." /><meta property="article:published_time" content="2022-08-04" /><meta property="article:author" content="Sayz Lim" /><meta property="og:image" content="https://images.sayzlim.net/2022/08/keyboard-maestro-default-state.webp" /><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@sayzlim"><meta name="twitter:title" content="How to create a robust and reliable Keyboard Maestro macro"><meta name="twitter:description" content="I've written my fair share of macros and put together a series of tips to help you efficiently build and debug a macro."><meta name="twitter:image:src" content="https://images.sayzlim.net/2022/08/keyboard-maestro-default-state.webp"><link rel="pingback" href="https://webmention.io/sayzlim.net/xmlrpc" /><link rel="webmention" href="https://webmention.io/sayzlim.net/webmention" /> <script async defer data-website-id="35992e34-11d0-4168-8d6c-4a4c796417ef" data-domains="sayzlim.net" src="https://stats.sayzlim.net/umami.js" ></script><body><div class="container"><header class="header"><nav class="nav-item"><ul><li><a href="/" >Home</a><li><a href="/posts/" >Posts</a><li><a href="/tags/" >Tags</a><li><a href="/tools/" >Tools</a><li></ul></nav><aside class="select-theme"> <button onclick="_manager.resetUserTheme()" aria-label="Enable System Theme"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> </button> <button onclick="_manager.setTheme('light')" aria-label="Enable Light Theme"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg> </svg> </button> <button onclick="_manager.setTheme('dark')" aria-label="Enable Dark Theme"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg> </button></aside></header><main class="prose flow"><div class="sidebar-promo form"><p> <strong>Save time by automating simple tasks.</strong> Tyro is designed for the apprentice in Keyboard Maestro. You will receive a group of macros that solve simple problems with built-in actions. Learn how to build an efficient macro by watching how it is built. — <a href="/lab/tyro/" target="_blank" rel="noopener noreferrer">Get Tyro</a></p></div><section class="post flow" itemscope itemtype="https://schema.org/BlogPosting"><header class="flow"><h1 itemprop="headline"> <a itemprop="url" href="/keyboard-maestro-macro-tips/">How to create a robust and reliable Keyboard Maestro macro</a></h1><div class="post-author"><div class="post-avatar"><img src="/img/sayzlim.jpg" alt="Sayz Lim"><span class="schema-author" itemprop="author" itemprop="publisher">Sayz Lim</span></div><div class="post-date"> <span>Published</span> <time itemprop="datePublished" datetime="2022-08-04">Aug 04, 2022</time></div><div class="post-tag"> <span>Tagged</span><ul class="post-tags"><li><a href="/tag/keyboard-maestro">Keyboard Maestro</a></ul></div></div></header><article itemprop="articleBody" class="flow"><p>Building a reliable macro can be challenging if you have to run a series of sub-macros together. I’ve written my fair share of macros and put together a series of tips to help you efficiently build and debug a macro.</p><h2 id="setup-the-macro-default-state">Setup The Macro Default State</h2><p>You want to <strong>set a consistent default state</strong> if you’re building a macro that involves a series of sub-macros. Setting a default state is like moving the chess pieces to the starting position after you’ve finished the game.</p><p>Setting a default state is essential if the macro you build needs to deal with multiple application windows running in full screen.</p><p><img src="https://images.sayzlim.net/2022/08/keyboard-maestro-default-state.webp" alt="" title="Keyboard Maestro Macro Default State" /></p><p>Here is an example.</p><p>You want to set up a workspace that involves creating and resizing multiple Safari windows on a different screen. The default state will be a Safari application with all the windows closed. The macro will start by pressing <code class="language-plaintext highlighter-rouge">Command-Option-Q</code> to quit and close all windows.</p><p>The same can be said when you’re building a macro that pulls data from the spreadsheet tab and enter them into a different application. The default state is to close irrelevant documents and browser tabs. Then you can launch the applications for the macro to run.</p><h2 id="set-between-actions-delay">Set Between Actions Delay</h2><p>Another common problem with macro is that they can run too fast. Sometimes the application won’t be ready to respond to your macro in time and create unexpected behaviors. For example, the macro will type the value before the input field is focused.</p><p>The workaround is pretty simple. You can set an action delay between macro to 0.2 seconds at the beginning of the macro. Play around with the value until you can ensure that the macro runs consistently.</p><p class="sidenote">You can also resolve these unexpected behaviors by implementing control flows. I’ve published a <a href="https://sayzlim.net/building-keyboard-maestro-macros-tips/">collection of tips</a> to help you build your first macro before. Although it hasn’t been updated for a while, these tips are still relevant today.</p><h2 id="declutter-with-local-or-instance-variables">Declutter with Local or Instance Variables</h2><p>Variables are wonderful pieces of Keyboard Maestro. You can use it to combine a series of macros to build a simple application.</p><p>The common mistake with people new to Keyboard Maestro is saving variables globally. You can check if you’ve been using global variables by opening the <strong>Preferences Variables</strong> settings. Most of the time, you don’t have to expose those variables to every macro.</p><p><img src="https://images.sayzlim.net/2022/08/keyboard-maestro-variables-preferences.webp" alt="" title="Keyboard Maestro Value Preferences" /></p><p>The solution for the problem is to prepend <code class="language-plaintext highlighter-rouge">Local</code> or <code class="language-plaintext highlighter-rouge">Instance</code> to the variable so it’s available only for the executing macro during the runtime.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">1</a></sup></p><p>The difference between these two is how accessible they are to the executing macro. Most of the time, you can use local variables, but you want to use instance variables when:</p><ul><li>You want the variable accessible by the sub-macros from the executing macro.<li>You want to keep the variable unique for each execution. For example, assuming you have a macro where you save file name to a variable called <code class="language-plaintext highlighter-rouge">InstanceFileName</code>. You can run the macro multiple times and each <code class="language-plaintext highlighter-rouge">InstanceFileName</code> will be unique even if macros run concurrently. Instance variables are useful when you have a macro that does many things in the background and you prefer not to wait for them to run sequentially.</ul><h2 id="debug-with-value-inspector">Debug with Value Inspector</h2><p>Once you start chaining multiple actions together, you will notice that you often need to check the value of the variables or tokens you plan to use. Keyboard Maestro has a built-in inspector where you can preview the value of variables. You can enable them by pressing <kbd>Command - 6</kbd> or selecting it from <strong>Window - Value Inspector</strong>.</p><p><img src="https://images.sayzlim.net/2022/08/keyboard-maestro-value-inspector.webp" alt="" title="Keyboard Maestro Value Inspector" /></p><p>Keyboard Maestro also comes with a <a href="https://wiki.keyboardmaestro.com/Tokens#List_of_Tokens">variety of tokens</a> that you can use to set up your macro. A common token you want to use is the <code class="language-plaintext highlighter-rouge">ICUDateTime</code> token, where you can customize the date format. For example, you can enter <code class="language-plaintext highlighter-rouge">%ICUDateTime%yyyy-MM-dd% </code> in the inspector to see what it looks like before implementing it in the macro.</p><div class="footnotes" role="doc-endnotes"><ol><li id="fn:2" role="doc-endnote"><p>You can <a href="https://wiki.keyboardmaestro.com/manual/Variables">learn more about variables</a> from Keyboard Maestro documentation. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></article></section><aside class="related-posts"><h5>Related Posts</h5><div class="related-box"><div class="related-card"><div class="related-date">Jul 01, 2022</div><a href="/loop-repeat-macros-keyboard-maestro/"><div class="related-title">How to Repeat Actions and Macros in Keyboard Maestro</div><div class="related-desc">Learn the best practice to repeat macros in Keyboard Maestro with the repeat action.</div></a><ul class="excerpt-tags"><li><a href="/tag/keyboard-maestro">Keyboard Maestro</a></ul></div><div class="related-card"><div class="related-date">Jun 04, 2022</div><a href="/better-quit-all/"><div class="related-title">Better "Quit All" with Keyboard Maestro</div><div class="related-desc">Combine Alfred and Keyboard Maestro to create a shortcut that quits all applications and choose which apps to keep active in the Dock.</div></a><ul class="excerpt-tags"><li><a href="/tag/alfred">Alfred</a><li><a href="/tag/keyboard-maestro">Keyboard Maestro</a></ul></div><div class="related-card"><div class="related-date">May 19, 2022</div><a href="/text-expansion-keyboard-maestro/"><div class="related-title">Text Expansion with Keyboard Maestro</div><div class="related-desc">Tips to use Keyboard Maestro as the main tool to expand most frequently used words.</div></a><ul class="excerpt-tags"><li><a href="/tag/keyboard-maestro">Keyboard Maestro</a><li><a href="/tag/textexpander">TextExpander</a></ul></div><div class="related-card"><div class="related-date">Mar 23, 2021</div><a href="/default-window-size-keyboard-maestro/"><div class="related-title">How to Set Default Window Size on Mac with Keyboard Maestro</div><div class="related-desc">Learn the easiest way to set a default window size for your Mac applications with this Keyboard Maestro macro.</div></a><ul class="excerpt-tags"><li><a href="/tag/keyboard-maestro">Keyboard Maestro</a></ul></div></div></aside></main><aside class="sidebar"><div class="sticky-box"><div class="carbon-box"> <script async src="//cdn.carbonads.com/carbon.js?serve=CKYIC2JI" id="_carbonads_js"></script></div></div></aside><aside class="hello flow"><p> 👋 <strong>Thanks for visiting this site!</strong> Would you mind if I tell you more about what I create?</p><button onclick="toggleElement('.overlay');dismissElement('.hello')";>Sure</button> <button onclick="dismissElement('.hello')">Maybe next time</button></aside><aside class="overlay"><section class="flow"> <button id="close" onclick="dismissElement('.overlay')"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button><p> I want to show you that you don't have to be a programmer to build useful <em>programs</em> that can solve your day-to-day problems. You can delegate your jobs to your computer. You can rest while your computer works.</p><p>Enter your email address below to receive Keyboard Maestro tips every week.</p><form class="form" action="https://app.convertkit.com/forms/2056450/subscriptions" method="post" data-sv-form="2056450" data-uid="c249fe0755" data-options='{"settings":{"after_subscribe":{"action": "redirect","redirect_url": "https://sayzlim.net/welcome/"}}}' > <label for="name">First Name</label> <input type="text" value="" name="fields[first_name]" placeholder="First Name" id="name" required /> <label for="email">Email</label> <input type="email" value="" name="email_address" placeholder="Email Address" id="email" required /> <button class="subscribe">Subscribe</button> </form></section></aside><footer class="footer"> &copy; 2010–2022 Sayz Lim | Powered by <a href="https://jekyllrb.com" title="Jekyll">Jekyll</a> and <a href="https://pages.github.com" title="GitHub Pages">GitHub Pages</a></footer></div>
