<!DOCTYPE html><html lang='en'><head prefix="og: http://ogp.me/ns/article#"><meta charset='utf-8'><title>How to add a theme selection feature with vanilla JavaScript | Sayz Lim</title><meta name="description" content="Learn how to let your site visitors to select dark or light theme on your site with this tutorial."><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="/main.css?v=1656993120" as="style"><link rel="stylesheet" href="/main.css?v=1656993120" > <script src="/main.js?v=1656993120"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Viga&family=Karla:wght@300;400;500;600&display=swap" rel="stylesheet"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="apple-touch-icon" sizes="56x56" href="/img/apple-touch-icon-56x56.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><meta name="twitter:dnt" content="on"><meta name="format-detection" content="telephone=no"><link rel="alternate" type="application/rss+xml" title="Sayz Lim" href="https://sayzlim.net/atom.xml" /><meta property="og:title" content="How to add a theme selection feature with vanilla JavaScript" /><meta property="og:type" content="article" /><meta property="og:url" content="https://sayzlim.net/theme-selection-javascript/" /><meta property="og:description" content="Learn how to let your site visitors to select dark or light theme on your site with this tutorial." /><meta property="article:published_time" content="2022-08-26" /><meta property="article:author" content="Sayz Lim" /><meta property="og:image" content="" /><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@sayzlim"><meta name="twitter:title" content="How to add a theme selection feature with vanilla JavaScript"><meta name="twitter:description" content="Learn how to let your site visitors to select dark or light theme on your site with this tutorial."><meta name="twitter:image:src" content=""><link rel="pingback" href="https://webmention.io/sayzlim.net/xmlrpc" /><link rel="webmention" href="https://webmention.io/sayzlim.net/webmention" /> <script async defer data-website-id="35992e34-11d0-4168-8d6c-4a4c796417ef" data-domains="sayzlim.net" src="https://stats.sayzlim.net/umami.js" ></script><body><div class="container"><header class="header"><nav class="nav-item"><ul><li><a href="/" >Home</a><li><a href="/posts/" >Posts</a><li><a href="/tags/" >Tags</a><li><a href="/tools/" >Tools</a><li></ul></nav><aside class="select-theme"> <button onclick="_manager.resetUserTheme()" aria-label="Enable System Theme"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> </button> <button onclick="_manager.setTheme('light')" aria-label="Enable Light Theme"> <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg> </svg> </button> <button onclick="_manager.setTheme('dark')" aria-label="Enable Dark Theme"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg> </button></aside></header><div class="layout:sidebar"><main class="prose flow"><section class="post flow" itemscope itemtype="https://schema.org/BlogPosting"><header class="flow"><h1 itemprop="headline"> <a itemprop="url" href="/theme-selection-javascript/">How to add a theme selection feature with vanilla JavaScript</a></h1><div class="post-author"><div class="post-avatar"><img src="/img/sayzlim.jpg" alt="Sayz Lim"><span class="schema-author" itemprop="author" itemprop="publisher">Sayz Lim</span></div><div class="post-date"> <span>Published</span> <time itemprop="datePublished" datetime="2022-08-26">Aug 26, 2022</time></div><div class="post-tag"> <span>Tagged</span><ul class="post-tags"><li><a href="/tag/html">HTML</a><li><a href="/tag/javascript">JavaScript</a></ul></div></div></header><article itemprop="articleBody" class="flow"><p>In the previous post, I explained how to automatically set a dark theme using a CSS media query to check site visitors’ device preferences. Next, I will show you how to let users select the site theme by writing a few JavaScript functions.</p><p>You can also <a href="https://codepen.io/sayzlim/pen/XWEVmRL" title="Theme Selection Demo on CodePen">check out the demo</a> if you wish to skip the whole guide to show you how it works.</p><p>If you have followed the guideline to set a dark theme before, you will notice that we’ve used a <code class="language-plaintext highlighter-rouge">:not()</code> pseudo class to apply the dark theme when the <code class="language-plaintext highlighter-rouge">:root</code> element doesn’t contain <code class="language-plaintext highlighter-rouge">data-site-theme</code> as the attribute.</p><div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@media</span> <span class="p">(</span><span class="n">prefers-color-scheme</span><span class="o">:</span> <span class="n">dark</span><span class="p">)</span> <span class="p">{</span>
	<span class="nd">:root:not</span><span class="o">([</span><span class="nt">data-site-theme</span><span class="o">])</span> <span class="p">{</span>
		<span class="na">--theme-color-background-400</span><span class="p">:</span> <span class="si">#{</span><span class="nv">$color-charcoal-400</span><span class="si">}</span><span class="p">;</span>
		<span class="na">--theme-color-background-500</span><span class="p">:</span> <span class="si">#{</span><span class="nv">$color-charcoal-300</span><span class="si">}</span><span class="p">;</span>
		<span class="c1">// The rest of the dark theme color tokens</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p class="sidenote">In HTML, <code class="language-plaintext highlighter-rouge">:root</code> represents the <code class="language-plaintext highlighter-rouge">&lt;html&gt;</code> element and is identical to the selector html, except that <strong>its specificity is higher</strong>.</p><p>Building a feature for site visitors to select the site theme requires a few requirements:</p><ol><li>We need a way to store the user option.<li>We need to add some UI elements for users to choose their preferred themes.<li>We need to update the CSS to support the selected theme.</ol><h2 id="creating-theme-manager-object">Creating Theme Manager Object</h2><p>One of my favorite design patterns is <strong>Command Pattern</strong>, where you can encapsulate actions as objects. For me, it’s the most straightforward design pattern to learn if you’re new to JavaScript because you’re only dealing with methods to manipulate DOM. For example, here is the complete snippet to create a theme manager that I use on my site.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">_manager</span> <span class="o">=</span> <span class="p">{</span>
	<span class="na">setTheme</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">userColorScheme</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">,</span> <span class="nx">userColorScheme</span><span class="p">);</span>
		<span class="nb">document</span>
				<span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">html</span><span class="dl">'</span><span class="p">)</span>
				<span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">data-site-theme</span><span class="dl">'</span><span class="p">,</span> <span class="nx">userColorScheme</span><span class="p">);</span>
	<span class="p">},</span>
	<span class="na">setUserTheme</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span>
			<span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">)</span>
		<span class="p">)</span> <span class="p">{</span>
			<span class="kd">let</span> <span class="nx">userColorScheme</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">);</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">userColorScheme</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">},</span>
	<span class="na">resetUserTheme</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">);</span>
		<span class="nb">document</span>
				<span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">html</span><span class="dl">'</span><span class="p">)</span>
				<span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">data-site-theme</span><span class="dl">'</span><span class="p">);</span>
	<span class="p">},</span>
	<span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">setUserTheme</span><span class="p">();</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="nx">_manager</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
</code></pre></div></div><p>Let’s take a look at each method and its purpose.</p><h3 id="settheme">setTheme</h3><p><code class="language-plaintext highlighter-rouge">setTheme</code> is the method to set the site theme. Using the built-in <code class="language-plaintext highlighter-rouge">localStorage</code> property, you create a local item called <code class="language-plaintext highlighter-rouge">user-color-scheme</code> with the value you pass into the method. You then use <code class="language-plaintext highlighter-rouge">querySelector</code> to apply the value to <code class="language-plaintext highlighter-rouge">data-site-theme</code> attribute. Here is an example of an updated html data attribute when you run <code class="language-plaintext highlighter-rouge">_manager.setTheme('dark')</code>.</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span> <span class="na">data-site-theme=</span><span class="s">"dark"</span><span class="nt">&gt;</span>
</code></pre></div></div><p class="sidenote"><strong>Checking Local Storage</strong> — You can check the local storage value using Chrome Dev Tools and navigate to the Application tab. If you’re using Safari, you can check the Storage tab.</p><h3 id="setusertheme">setUserTheme</h3><p>The method’s purpose is to apply a user theme if we detect any values in the local storage. First, we check if there is any value by using <code class="language-plaintext highlighter-rouge">localStorage.getItem('user-color-scheme')</code> function. If we detect a value, we will apply them by calling the <code class="language-plaintext highlighter-rouge">setTheme</code> method we built earlier.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setUserTheme</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span>
		<span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">)</span>
	<span class="p">)</span> <span class="p">{</span>
		<span class="kd">let</span> <span class="nx">userColorScheme</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">);</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">setTheme</span><span class="p">(</span><span class="nx">userColorScheme</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h3 id="resetusertheme">resetUserTheme</h3><p>Although it’s nice to allow site visitors to choose their theme, we also need to offer a way for them to reset their choice for the site to match their device’s theme setting. This method will remove <code class="language-plaintext highlighter-rouge">user-color-scheme</code> item from the local storage and remove the <code class="language-plaintext highlighter-rouge">data-site-theme</code> attribute from the document.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">resetUserTheme</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">user-color-scheme</span><span class="dl">'</span><span class="p">);</span>
	<span class="nb">document</span>
			<span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">html</span><span class="dl">'</span><span class="p">)</span>
			<span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">data-site-theme</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="buttons-for-theme-selection">Buttons for Theme Selection</h2><p>With the theme manager ready to use, we can pass the methods into <code class="language-plaintext highlighter-rouge">onclick</code> event to set the user theme. You can wrap the SVG icon with the <code class="language-plaintext highlighter-rouge">button</code> element if you plan to use icons. Make sure to add <code class="language-plaintext highlighter-rouge">aria-label</code> attribute so the screen reader can read the button description.</p><p>Here is the structure of the buttons. Replace <code class="language-plaintext highlighter-rouge">SVG Icon</code> with the actual SVG value you can copy from free SVG icons sites like <a href="https://feathericons.com/">Feather Icons</a>.</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;aside</span> <span class="na">class=</span><span class="s">"select-theme"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;button</span>
		<span class="na">onclick=</span><span class="s">"_manager.resetUserTheme()"</span>
		<span class="na">aria-label=</span><span class="s">"Enable System Theme"</span>
	<span class="nt">&gt;</span>
		SVG Icon
	<span class="nt">&lt;/button&gt;</span>
	<span class="nt">&lt;button</span>
		<span class="na">onclick=</span><span class="s">"_manager.setTheme('light')"</span>
		<span class="na">aria-label=</span><span class="s">"Enable Light Theme"</span>
	<span class="nt">&gt;</span>
		SVG Icon
	<span class="nt">&lt;/button&gt;</span>
	<span class="nt">&lt;button</span>
		<span class="na">onclick=</span><span class="s">"_manager.setTheme('dark')"</span>
		<span class="na">aria-label=</span><span class="s">"Enable Dark Theme"</span>
	<span class="nt">&gt;</span>
		SVG Icon
	<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/aside&gt;</span>
</code></pre></div></div><p>Following the guide above, you should have functional buttons that allow you to update your site theme. I didn’t cover how to style the buttons because it’s beyond the scope of this guide. I only want to show you how I put the structure together by taking inspiration from other sites.</p></article></section><aside class="related-posts"><h5>Related Posts</h5><div class="related-box"><div class="related-card"><div class="related-date">Mar 03, 2021</div><a href="/plain-html-form-convertkit/"><div class="related-title">Building a Plain HTML Form with ConvertKit</div><div class="related-desc">Follow this guide to integrate ConvertKit into your website by building a lightweight HTML form without loading additional scripts.</div></a><ul class="excerpt-tags"><li><a href="/tag/convertkit">ConvertKit</a><li><a href="/tag/html">HTML</a></ul></div></div></aside></main><aside class="sidebar"><div class="sticky-box"><div class="sidebar-promo form"><p><strong>Support my first digital product!</strong><br> A bundle of Keyboard Maestro macros to supercharge your workspace and get things done faster.<br><a href="/lab/tyro/">Get Tyro</a></p></div><div class="carbon-box"> <script async src="//cdn.carbonads.com/carbon.js?serve=CKYIC2JI" id="_carbonads_js"></script></div></div></aside></div><aside class="hello flow"><p> 👋 <strong>Thanks for visiting this site!</strong> Would you mind if I tell you more about what I create?</p><button onclick="toggleElement('.overlay');dismissElement('.hello')";>Sure</button> <button onclick="dismissElement('.hello')">Maybe next time</button></aside><aside class="overlay"><section class="flow"> <button id="close" onclick="dismissElement('.overlay')"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button><p> I want to show you that you don't have to be a programmer to build useful <em>programs</em> that can solve your day-to-day problems. You can delegate your jobs to your computer. You can rest while your computer works.</p><p>Enter your email address below to receive Keyboard Maestro tips every week.</p><form class="form" action="https://app.convertkit.com/forms/2056450/subscriptions" method="post" data-sv-form="2056450" data-uid="c249fe0755" data-options='{"settings":{"after_subscribe":{"action": "redirect","redirect_url": "https://sayzlim.net/welcome/"}}}' > <label for="name">First Name</label> <input type="text" value="" name="fields[first_name]" placeholder="First Name" id="name" required /> <label for="email">Email</label> <input type="email" value="" name="email_address" placeholder="Email Address" id="email" required /> <button class="subscribe">Subscribe</button> </form></section></aside><footer class="footer"> &copy; 2010–2023 Sayz Lim | Powered by <a href="https://jekyllrb.com" title="Jekyll">Jekyll</a> and <a href="https://pages.github.com" title="GitHub Pages">GitHub Pages</a></footer></div>
